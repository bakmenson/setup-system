#+title: Setup System

#+property: header-args:shell :tangle-mode (identity #o555) :tangle setup-system.sh :shebang #!/bin/bash

* Table of Contents :toc:
- [[#pre-install][Pre-install]]
- [[#update][Update]]
- [[#apt][Apt]]
- [[#base-packages][Base packages]]
- [[#wm][WM]]
  - [[#i3-gaps][i3-gaps]]
- [[#snap][Snap]]
- [[#programming-languages][Programming Languages]]
  - [[#python][Python]]
  - [[#java][Java]]
  - [[#rust][Rust]]
  - [[#javascript][JavaScript]]
  - [[#sql][SQL]]
  - [[#bash][Bash]]
- [[#install-jetbrains-ide][Install JetBrains IDE]]
- [[#from-source][From source]]
  - [[#oh-my-zsh][Oh-my-zsh]]
  - [[#alacritty][Alacritty]]
- [[#emacs-config][Emacs Config]]
- [[#nyxt][Nyxt]]
- [[#dotfiles][Dotfiles]]
- [[#automount-hdd][Automount HDD]]
- [[#change-shell][Change Shell]]
- [[#usage][Usage]]

* Pre-install

#+begin_src shell
mkdir -p ~/dev
#+end_src

* Update

#+begin_src shell
sudo apt update && sudo apt dist-upgrade && sudo snap refresh
#+end_src

* Apt

#+begin_src shell
#sudo apt install $(cat ~/setup-system/packages.txt)
#+end_src

* Base packages

#+begin_src shell
sudo apt install cmake curl mpv htop neofetch npm python3-pip python3-venv vim tree gparted inxi \
ripgrep xfce4-power-manager sqlite3 zsh fzf papirus-icon-theme youtube-dl arc-theme fonts-jetbrains-mono
#+end_src

* WM
** i3-gaps

#+begin_src shell
sudo apt install libxcb1-dev libxcb-keysyms1-dev libpango1.0-dev libxcb-util0-dev libxcb-icccm4-dev libyajl-dev \
libstartup-notification0-dev libxcb-randr0-dev libev-dev libxcb-cursor-dev libxcb-xinerama0-dev \
libxcb-xkb-dev libxkbcommon-dev libxkbcommon-x11-dev autoconf libxcb-xrm0 libxcb-xrm-dev automake \
libxcb-shape0-dev

sudo apt install rofi feh dmune polybar scrot unclutter picom lxappearance

sudo add-apt-repository ppa:regolith-linux/release
sudo apt update
sudo apt install i3-gaps
#+end_src

* Snap

#+begin_src shell
sudo snap install emacs --classic
sudo snap install telegram-desktop
sudo snap install node --classic
sudo snap install kotlin --classic
#+end_src

* Programming Languages
** Python
*** Pip

#+begin_src shell
python3 -m pip install ipython
#+end_src

*** Pyenv

#+begin_src shell
sudo apt-get install make build-essential libssl-dev zlib1g-dev \
libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm \
libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev

if [ -d ~/.pyenv ]; then rm -rf ~/.pyenv; fi

git clone https://github.com/pyenv/pyenv .pyenv
#+end_src

*** Poetry

#+begin_src shell
curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/install-poetry.py | python3 -
mkdir ~/.oh-my-zsh/plugins/poetry
poetry completions zsh > ~/.oh-my-zsh/plugins/poetry/_poetry
#+end_src

** Java

#+begin_src shell
sudo apt install openjdk-8-jdk openjdk-8-source openjdk-8-doc openjdk-17-jdk openjdk-17-source openjdk-17-doc
#+end_src

** Rust

#+begin_src shell
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
#+end_src

** JavaScript
*** NPM

#+begin_src shell
sudo npm install -g typescript typescript-language-server js-beautify
#+end_src

** SQL
*** PostgreSQL

#+begin_src shell
sudo apt install postgresql postgresql-contrib
#+end_src

** Bash

#+begin_src shell
sudo npm i -g bash-language-server
#+end_src

* Install JetBrains IDE

#+begin_src shell
git clone https://github.com/bakmenson/jetbrains-downloader.git
while true; do
	printf "\n"
	python3 ~/jetbrains-downloader/downloader.py

	printf "\nDo you want install another IDE? (y/n)"
	read -s -n 1 answer
	[[ $answer == "" || $answer == "y" ]] || break
done
rm -rf jetbrains-downloader

if [ -f ~/.profile ]; then echo export _JAVA_AWT_WM_NONREPARENTING=1 >> ~/.profile; fi
#+end_src

* From source
** Oh-my-zsh

#+begin_src shell
if [ -d ~/.oh-my-zsh ]; then rm -rf ~/.oh-my-zsh; fi

git clone https://github.com/ohmyzsh/ohmyzsh ~/.oh-my-zsh
git clone https://github.com/zsh-users/zsh-syntax-highlighting ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting
git clone https://github.com/zsh-users/zsh-history-substring-search ~/.oh-my-zsh/custom/plugins/zsh-history-substring-search
git clone https://github.com/zsh-users/zsh-autosuggestions ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions
#+end_src

** Alacritty

#+begin_src shell
sudo apt install pkg-config libfreetype6-dev libfontconfig1-dev libxcb-xfixes0-dev libxkbcommon-dev

if [ -d ~/.alacritty ]; then rm -rf ~/.alacritty; fi

git clone https://github.com/alacritty/alacritty.git ~/.alacritty

cd ~/.alacritty
cargo build --release
sudo cp target/release/alacritty /usr/local/bin
cd ~/
#+end_src

* Emacs Config

#+begin_src shell
sudo apt install libvterm-dev

git clone https://github.com/cask/cask ~/.cask

git clone https://github.com/politza/pdf-tools .pdf-tools
cd .pdf-tools
make -s

if [ -d ~/dev/emacs-config ]; then rm -rf ~/dev/emacs-config; fi

git clone https://github.com/bakmenson/emacs-config.git ~/dev/emacs-config
emacs --batch --eval "(require 'org)" --eval '(org-babel-tangle-file "~/dev/emacs-config/README.org")'
#+end_src

* Nyxt

- =dependencies=

#+begin_src shell
sudo apt install libfixposix-dev libwebkit2gtk-4.0-dev xclip libfixposix3 libsoup2.4-dev libjavascriptcoregtk-4.0-dev libbrotli-dev libpsl-dev
#+end_src

- =download and install latest nyxt release=

#+begin_src shell
last_version=$(curl -s https://api.github.com/repos/atlas-engineer/nyxt/releases/latest | grep '"name":' | sed -E 's/.*"([^"]+)".*/\1/' | head -n 1)

package_name="nyxt_"${last_version}"_amd64.deb"

link="https://github.com/atlas-engineer/nyxt/releases/download/"${last_version}"/"${package_name}

wget ${link}

sudo apt install ./${package_name}

rm ${package_name}
#+end_src

* Dotfiles

#+begin_src shell
if [ -d ~/dev/dotfiles ]; then rm -rf ~/dev/dotfiles; fi

git clone https://github.com/bakmenson/dotfiles.git ~/dev/dotfiles

emacs --batch --eval "(require 'org)" --eval '(org-babel-tangle-file "~/dev/dotfiles/README.org")'

sudo chmod +x ~/.config/polybar/polybar.sh
#+end_src

* Automount HDD

#+begin_src shell
sudo tee -a /etc/fstab > /dev/null <<EOT
UUID=6883E43D19D297F7 /run/media/solus/hdd/      ntfs  errors=remount-ro,auto,exec,rw,user 0   0
EOT
#+end_src

* Change Shell

#+begin_src shell
chsh -s /bin/zsh
#+end_src

* Usage

#+begin_src shell :tangle no 
git clone https://github.com/bakmenson/setup-system
bash setup-system/install.sh
#+end_src
